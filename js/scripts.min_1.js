!function(e){"function"==typeof define&&define.amd?define("scripts",e):e()}((function(){"use strict";function e(e,o,n){document.cookie=[encodeURIComponent(e)+"="+encodeURIComponent(o),"max-age="+n,"path=/"].join("; ")}function o(e){for(var o=encodeURIComponent(e)+"=",n=document.cookie.split(";"),t=0;t<n.length;t++){for(var i=n[t];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(o))return decodeURIComponent(i.substring(o.length,i.length))}return null}var n=1e3,t=6e4,i=36e5,p=24*i,s=function(s){if(s&&!(s.length<0)){var a,r,u,c,l,d=JSON.parse(s.getAttribute("data-options")),_=(a=d.locale,u={day:{en:["day","days"],ru:["день","дня","дней"]},hour:{en:["hour","hours"],ru:["час","часа","часов"]},minute:{en:["minute","minutes"],ru:["минута","минуты","минут"]},second:{en:["second","seconds"],ru:["секунда","секунды","секунд"]}},c=void 0!==(r={en:function(e){return 1===e?0:1},ru:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}})[a]?r[a]:r.en,function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(void 0!==u[e]&&void 0!==u[e][a]){var n=c(o);if(void 0!==u[e][a][n])return u[e][a][n]}return e}),m=o(d.identity);if(null!==m){var f=m.split(".");m=parseInt(f[0]),l=f[1],parseInt(l)!==parseInt(d.time)&&(m=(new Date).getTime()+1e3*d.time,e(d.identity,[m,d.time].join("."),d.time))}else m=(new Date).getTime()+1e3*d.time,e(d.identity,[m,d.time].join("."),d.time);var w,h=new Date(m),v=(new Date).getTime(),y=Math.max(0,h-v),b=Math.floor(y/p),g=Math.floor(y%p/i),k=Math.floor(y%i/t),j=Math.floor(y%t/n),T="",x=!d.hide_empty||b>0,C=!d.hide_empty||g>0||x,E=!d.hide_empty||k>0||C;x&&(T+='<div class="'+d.class_prefix+'countdown__item js-mypopup-countdown-days"><div class="'+d.class_prefix+'countdown__num"><span class="js-mypopup-countdown-num"></span></div><div class="'+d.class_prefix+'countdown__label"><span class="js-mypopup-countdown-label"></span></div></div>'),C&&(T+='<div class="'+d.class_prefix+'countdown__item js-mypopup-countdown-hours"><div class="'+d.class_prefix+'countdown__num"><span class="js-mypopup-countdown-num"></span></div><div class="'+d.class_prefix+'countdown__label"><span class="js-mypopup-countdown-label"></span></div></div>'),E&&(T+='<div class="'+d.class_prefix+'countdown__item js-mypopup-countdown-minutes"><div class="'+d.class_prefix+'countdown__num"><span class="js-mypopup-countdown-num"></span></div><div class="'+d.class_prefix+'countdown__label"><span class="js-mypopup-countdown-label"></span></div></div>'),T+='<div class="'+d.class_prefix+'countdown__item js-mypopup-countdown-seconds"><div class="'+d.class_prefix+'countdown__num"><span class="js-mypopup-countdown-num"></span></div><div class="'+d.class_prefix+'countdown__label"><span class="js-mypopup-countdown-label"></span></div></div>',s.innerHTML=T;var M=function(){v=(new Date).getTime(),y=Math.max(0,h-v),b=Math.floor(y/p),g=Math.floor(y%p/i),k=Math.floor(y%i/t),j=Math.floor(y%t/n);var e=s.querySelector(".js-mypopup-countdown-days");null!==e&&(e.querySelector(".js-mypopup-countdown-num").innerHTML=b,e.querySelector(".js-mypopup-countdown-label").innerHTML=_("day",b));var o=s.querySelector(".js-mypopup-countdown-hours");null!==o&&(o.querySelector(".js-mypopup-countdown-num").innerHTML=d.start_with_zero&&g<10?"0"+g:g,o.querySelector(".js-mypopup-countdown-label").innerHTML=_("hour",g));var a=s.querySelector(".js-mypopup-countdown-minutes");null!==a&&(a.querySelector(".js-mypopup-countdown-num").innerHTML=d.start_with_zero&&k<10?"0"+k:k,a.querySelector(".js-mypopup-countdown-label").innerHTML=_("minute",k));var r=s.querySelector(".js-mypopup-countdown-seconds");r.querySelector(".js-mypopup-countdown-num").innerHTML=d.start_with_zero&&j<10?"0"+j:j,r.querySelector(".js-mypopup-countdown-label").innerHTML=_("second",j),y<=0&&(clearInterval(w),document.dispatchEvent(new CustomEvent("mypopup_countdown_elapsed",{detail:{el:s,identity:d.identity}})))};M(),w=setInterval(M,1e3)}};function a(e,o){for(var n=0;n<o.length;n++){var t=o[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,r(t.key),t)}}function r(e){var o=function(e,o){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,o||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}(e,"string");return"symbol"==typeof o?o:o+""}function u(e){try{return JSON.parse(o(e))||[]}catch(e){console.error(e)}return[]}var c=function(){return e=function e(o,n){!function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,e),this._cookieName=o,this.isPreview=n,this._popups=u(o)},(o=[{key:"getPopupsExcept",value:function(e){return this._popups.filter((function(o){return o.id!==e})).map((function(e){return{id:e.id,time:e.time,show_on:!!e.show_on}}))}},{key:"setAllPopups",value:function(e){return this._popups=e,function(e,o,n){var t;if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),t="; expires="+i.toGMTString()}else t="";document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+t+"; path=/"}(this._cookieName,JSON.stringify(e),this.isPreview?0:"3650"),this}},{key:"isHidden",value:function(e){var o=Math.floor((new Date).getTime()/1e3),n=!1;return this._popups.filter((function(o){return o.id===e.id})).forEach((function(e){e.time>o&&(n=!0)})),n}}])&&a(e.prototype,o),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,n}();jQuery((function(e){var o=150,n=!!(my_popup_ajax||{}).is_preview,t=new c(n?"my_popup_hide__preview":"my_popup_hide",n),i=function(){this.stack=[],e(document).keyup(function(e){if(27===e.keyCode){var o=this.stack.pop();o&&"function"==typeof o.callback&&o.callback()}}.bind(this))};i.prototype.push=function(e,o){return this.off(e),this.stack.push({name:e,callback:o}),this},i.prototype.off=function(e){return this.stack=this.stack.filter((function(o){return o.name!==e})),this};var p=new i,a=!1,r=!1,u=!1,l=!1,d=!1,_=!1,m=!1;function f(){a&&h.forEach((function(e){e.show_popup_time_enabled&&void 0===e._showTimout&&(e._showTimout=setTimeout((function(){e.is_show||(b(e),e.is_show=!0)}),e.show_popup_time_value))})),r&&!_&&(window.addEventListener("scroll",j(v),!0),window.addEventListener("resize",j(v),!0),_=!0),u&&!m&&(window.addEventListener("scroll",j(y),!0),m=!0),l&&h.forEach((function(o){if(o.show_popup_inactive_enabled){var n=0;e(document).ready((function(){var t=setInterval((function(){n+=1,!o.is_show&&n>o.show_popup_inactive_value&&(b(o),o.is_show=!0,clearInterval(t))}),1e3);e(this).mousemove((function(e){n=0})),e(this).keypress((function(e){n=0}))}))}})),d&&h.forEach((function(o){o.show_popup_leaves_page&&e(document).mouseleave((function(e){!o.is_show&&e.clientY<100&&(b(o),o.is_show=!0)}))}))}function w(o){e("body").append(o);var n=o.attr("id"),t=o.data("options");t.show_popup_time_enabled&&(a=!0),t.show_popup_scroll_enabled&&(r=!0),t.show_popup_element_enabled&&(u=!0),t.show_popup_inactive_enabled&&(l=!0),t.show_popup_leaves_page&&(d=!0);var i={id:n,is_show:!1,popup_position:t.popup_position,cookies_enabled:!!parseInt(t.cookies_enabled),cookies_type:t.cookies_type,cookies_value:t.cookies_value,enable_overlay:t.enable_overlay,close_button_enabled:t.close_button_enabled,close_button_time:t.close_button_time,close_overlay:t.close_overlay,close_esc:t.close_esc,scroll_lock:t.scroll_lock,close_popup_enabled:t.close_popup_enabled,close_popup_time:t.close_popup_time,overlay_color:t.overlay_color,overlay_opacity:t.overlay_opacity,show_popup_time_enabled:t.show_popup_time_enabled,show_popup_time_value:t.show_popup_time_value,show_popup_scroll_enabled:t.show_popup_scroll_enabled,show_popup_scroll_value:t.show_popup_scroll_value,show_popup_element_enabled:t.show_popup_element_enabled,show_popup_element_value:t.show_popup_element_value,show_popup_inactive_enabled:t.show_popup_inactive_enabled,show_popup_inactive_value:t.show_popup_inactive_value,show_popup_leaves_page:t.show_popup_leaves_page,show_on_click:t.show_popup_on_click,show_on_click_selector:t.show_popup_on_click_selector};i.show_on_click&&i.show_on_click_selector&&e(document).on("click",i.show_on_click_selector,(function(e){e.preventDefault(),b(i,!1),i.is_show=!0})),h.push(i)}window.appendMyPopup=w,window.initMyPopups=f;var h=[];function v(){h.forEach((function(e){e.show_popup_scroll_enabled&&function(){var e=window.hasOwnProperty("pageYOffset")?window.pageYOffset:window.scrollTop,o=isNaN(window.innerHeight)?window.clientHeight:window.innerHeight,n=parseInt(100*e/(t=document.body,i=document.documentElement,Math.max(t.scrollHeight,t.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight)-o));var t,i;n<=0&&(n=0);n>=100&&(n=100);return n}()>=e.show_popup_scroll_value&&!e.is_show&&(b(e),e.is_show=!0)}))}function y(){h.forEach((function(o){if(o.show_popup_element_enabled){var n=e(o.show_popup_element_value).offset().top;(window.hasOwnProperty("pageYOffset")?window.pageYOffset:window.scrollTop)>n-(isNaN(window.innerHeight)?window.clientHeight:window.innerHeight)&&!o.is_show&&(b(o),o.is_show=!0)}}))}function b(n){var i,a;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&t.isHidden(n)||(n.enable_overlay&&(i=n.id,(a=document.createElement("div")).className="mypopup-over",a.id=i+"_over",h.forEach((function(o){o.overlay_color&&e("mypopup-over").css({"background-color":o.overlay_color}),o.overlay_opacity&&e("mypopup-over").css({opacity:o.overlay_opacity,"filter: alpha(opacity=":o.overlay_opacity}),o.close_overlay||e(a).on("click",(function(e){k(i)}))})),document.body.append(a),n.overlay_color&&e(".mypopup-over").css({"background-color":n.overlay_color}),n.overlay_opacity&&e(".mypopup-over").css({opacity:n.overlay_opacity})),setTimeout((function(){!function(n){e(document.body).addClass("mypopup-open"),n.scroll_lock&&setTimeout((function(){e(document.body).addClass("mypopup-scroll-lock")}),o)}(n);var t,i=e("#"+n.id),a=function(e){if(void 0===e.data("content"))return"";try{var o=decodeURIComponent(T(e.data("content")));return e.removeData("content"),e.removeAttr("data-content"),o}catch(e){console.error(e)}return""}(i);i.append(a),i.show((function(){document.dispatchEvent(new CustomEvent("my_popup_show",{detail:{$popup:i}}))})),i.find(".mypopup-modal-close.js-mypopup-modal-close").hide(),n.close_button_enabled&&setTimeout((function(){i.find(".mypopup-modal-close.js-mypopup-modal-close").show()}),n.close_button_time),g(n.id),[100,500,1e3,2e3].forEach((function(e){return setTimeout((function(){return g(n.id)}),e)})),e(window).resize((function(){g(n.id)})),i.on("click",(function(e){e.target===e.currentTarget&&k(n.id)})),n.close_esc||p.push(n.id,(function(){k(n.id)})),n.close_popup_enabled&&setTimeout((function(){k(n.id)}),n.close_popup_time),t=document.querySelectorAll("#"+n.id+" .js-mypopup-countdown"),NodeList.prototype.isPrototypeOf(t)?t.forEach(s):s(t)}),10))}function g(o){var n=e(window).height();h.filter((function(e){return e.id===o})).forEach((function(o){var t=e("#modal_"+o.id).outerHeight();t+120>n?e("#modal_content_"+o.id).css({"max-height":n-40,"overflow-y":"auto"}):"center_left"!==o.popup_position&&"center_center"!==o.popup_position&&"center_right"!==o.popup_position||e("#modal_"+o.id).css({"margin-top":(n-t)/2})}))}function k(i){if(!n){var s=h.filter((function(e){return e.id===i}));if(!s.length)return!1;s=s[0],p.off(s.id);var a=t.getPopupsExcept(i),r=Math.floor((new Date).getTime()/1e3),u=s.cookies_enabled,c=Math.floor((new Date).getTime()/1e3);s.cookies_enabled?s.cookies_value&&("minutes"===s.cookies_type?r=c+60*s.cookies_value:"hours"===s.cookies_type?r=c+60*s.cookies_value*60:"days"===s.cookies_type?r=c+24*s.cookies_value*60*60:"months"===s.cookies_type&&(r=c+30*s.cookies_value*24*60*60)):r=c+31536e4,a.push({id:i,time:r,show_on:u}),t.setAllPopups(a),e(document.body).removeClass("mypopup-open"),e(document.body).removeClass("mypopup-scroll-lock"),setTimeout((function(){e("#"+i+"_over").remove(),e("#"+i).hide()}),o)}}function j(e,o){void 0===o&&(o=250);var n,t,i=!1;return function p(){if(i)return n=arguments,void(t=e);e.apply(e,arguments),i=!0,setTimeout((function(){i=!1,n&&(p.apply(t,n),n=t=null)}),o)}}function T(e){if("undefined"==typeof window)return new Buffer(e,"base64").toString("utf-8");if(void 0!==window.atob)return decodeURIComponent(escape(window.atob(e)));var o,n,t,i,p,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=0,u=0,c="",l=[];if(!e)return e;e+="";do{o=(s=a.indexOf(e.charAt(r++))<<18|a.indexOf(e.charAt(r++))<<12|(i=a.indexOf(e.charAt(r++)))<<6|(p=a.indexOf(e.charAt(r++))))>>16&255,n=s>>8&255,t=255&s,l[u++]=64===i?String.fromCharCode(o):64===p?String.fromCharCode(o,n):String.fromCharCode(o,n,t)}while(r<e.length);return c=l.join(""),decodeURIComponent(escape(c.replace(/\0+$/,"")))}e(".js-mypopup-container").each((function(){w(e(this))})),f(),function(){if(void 0===window.myPopupInitData)return;e.ajax({type:"post",url:my_popup_ajax.url,data:{nonce:my_popup_ajax.nonce,action:"my_popup_init_data",params:window.myPopupInitData.params}}).done((function(o){o.success?(o.data.items.forEach((function(o){w(e(o))})),f()):console.log(o)}))}(),window.myPopupShow=function(e){return h.filter((function(o){return o.id===e})).forEach((function(e){e.show_on_click&&(b(e),e.is_show=!0)})),!1},window.myPopupClose=function(o){if("string"==typeof o)k(o);else{var n=e(o).parents(".mypopup-modal");n.length&&k(n.attr("id").substring(6))}},document.addEventListener("click",(function(o){n&&(e(o.target).blur(),o.stopPropagation(),o.preventDefault(),console.warn("prevent all clicks in preview mode"))}),!0),e(document).on("click",".js-mypopup-modal-close",(function(){k(e(this).parents(".js-mypopup-container").attr("id"))})),e(document).on("click",".js-mypopup-link",(function(){var o=e(this).data("href");if(o){var n;try{n=new URL(o)}catch(e){}if(void 0===n)try{n=new URL(T(o))}catch(e){console.error("Unable to parse encoded url")}void 0!==n&&window.open(n)}})),e(document).on("submit",".mypopup-body form",(function(o){var n=e(o.target),t=n.find('input[data-name="my-popup-form-options"]');if(t.length){o.preventDefault();var i=function(o,t){var i=e("<span>").addClass("mypopup-modal__message mypopup-modal__message--"+t);i.text(o),n.find(".mypopup-modal__message").remove(),n.prepend(i)};e.ajax({type:"POST",url:n.attr("action"),data:n.serialize(),beforeSend:function(){n.find('*[type="submit"]').attr("disabled",!0)},success:function(e){e.success?(e.data&&e.data.message&&i(e.data.message,"success"),t.data("close_time")&&setTimeout((function(){return myPopupClose(n)}),t.data("close_time"))):e.data&&e.data.message&&i(e.data.message,"error")}}).always((function(){n.find('*[type="submit"]').attr("false",!0)}))}}))}))}));